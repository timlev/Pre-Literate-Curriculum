<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <link href="https://fonts.googleapis.com/css2?family=Didact+Gothic&amp;display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Sen&amp;display=swap" rel="stylesheet"/>
  <link href="../drag_n_drop_theme.css" rel="stylesheet" type="text/css"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/css/base/jquery.ui.all.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.2/css/lightness/jquery-ui-1.10.2.custom.min.css" rel="stylesheet"/>
  <script src="https://code.jquery.com/jquery-1.7.2.min.js">
  </script>
  <script src="https://code.jquery.com/ui/1.8.21/jquery-ui.min.js">
  </script>
  <script src="../jquery.ui.touch-punch.min.js">
  </script>
  <script>
   var i = 0;
var all_words = document.getElementsByClassName("source");

function finished_playing_list(event){
	console.log(event.target.id + "Finished");
	var txtObj = document.getElementById(event.target.id.replace("_audio",""));
	txtObj.style.backgroundColor = 'transparent';
	play_sound(play_sound);
}

function finished_playing(event){
	console.log(event.target.id + "Finished");
        var txtid = event.target.id.replace("_audio","");
	var txtObj = document.getElementById(txtid);
	txtObj.style.backgroundColor = 'transparent';
}

function play_sound(play_sound){
	if (i < all_words.length){
		var word = all_words[i].id;
		console.log(word);
		var next_word = word + "_audio";
		txtObj = document.getElementById(word);
		audioObj = document.getElementById(next_word);
		//audioObj.onended = finished_playing;
		$(audioObj).on("ended", finished_playing_list);
		txtObj.style.backgroundColor = "yellow";
		document.getElementById(next_word).play();
		i += 1;
	}
	else {
		i = 0;
		$(".source_audio").off();
		$(".source_audio").on("ended",finished_playing);
		//document.getElementById("playallbutton").remove();
	}
}

function tapHandler(event){
    var audioId = event.target.id;
    if (audioId.includes("_sound_button")){
        audioId = audioId.replace("_sound_button","_audio");
    }
    else {
        audioId = audioId + "_audio";
    }
    txtObj = document.getElementById(audioId.replace("_audio",""));
    console.log(txtObj);
    audioObj = document.getElementById(audioId);
    audioObj.addEventListener("ended",finished_playing);
    txtObj.style.backgroundColor = "yellow";
    audioObj.play();
};

$(function() {
  var score = 0;
window.words_remaining = 0;
console.log(window.orientation);

  $(".source").on("dragstart", tapHandler );
  $(".sound_button").on("click",tapHandler);
  $( ".source" ).draggable({ revert: "invalid", scroll: false});
  $( ".destination" ).droppable({
    drop: function( event, ui ) {
      var dragged_category = ui.draggable.attr("name").split(",")[0];
      var dropped_category = $(this).attr("name").split(",")[0];
      if (ui.draggable.attr("name") == $(this).attr("name")){
          ui.draggable.draggable("disable");
          // $(this).css({"background-color":"#70db70"});
    		$(this).removeClass("wrong_answer");
    		$(this).addClass("correct_answer");
            document.getElementById(ui.draggable.attr("id") + "_sound_button").remove();
          $(this).html(ui.draggable.html());
          ui.draggable.hide();
  //$(this).toggleClass("source");
          score += 1;
  $(this).droppable({disabled: true});
  console.log(window.words_remaining);
          window.words_remaining -= 1;
          moves += 1;
          $("#status").text("Current score: " + score + " Words remaining: " + window.words_remaining);
          if (window.words_remaining == 0){
             document.getElementById("menu_link").innerHTML = "Finished!<br>Current score: " + score + " Words remaining: " + window.words_remaining + "<br>Moves: " + moves
          }
    }
    else{
        //ui.draggable.css({"color":"red"});
				ui.draggable.addClass("wrong_answer");
        moves += 1;

    }

    }
  });
});

    var score = 0;
    var moves = 0;
  </script>
  <title>
   ../3 - Jobs/2 Jobs
  </title>
 </head>
 <body>
  <div id="header">
   <div id="back_button">
    Back
    <img src="../images/back_button.png"/>
   </div>
   <div id="title">
    2 Jobs
   </div>
  </div>
  <table id="pictures_and_destinations">
   <tr id="1">
    <td id="1a">
     <div class="image">
      <img src="imgs/office worker.jpg"/>
     </div>
     <div class="destination" id="droppable" name="1,a">
     </div>
    </td>
    <td id="1b">
     <div class="image">
      <img src="imgs/driver.jpg"/>
     </div>
     <div class="destination" id="droppable" name="1,b">
     </div>
    </td>
    <td id="1c">
     <div class="image">
      <img src="imgs/cashier.jpg"/>
     </div>
     <div class="destination" id="droppable" name="1,c">
     </div>
    </td>
    <td id="1d">
     <div class="image">
      <img src="imgs/factory worker.jpg"/>
     </div>
     <div class="destination" id="droppable" name="1,d">
     </div>
    </td>
   </tr>
   <tr id="2">
    <td id="2a">
     <div class="image">
      <img src="imgs/doctor.jpg"/>
     </div>
     <div class="destination" id="droppable" name="2,a">
     </div>
    </td>
    <td id="2b">
     <div class="image">
      <img src="imgs/mechanic.jpg"/>
     </div>
     <div class="destination" id="droppable" name="2,b">
     </div>
    </td>
    <td id="2c">
     <div class="image">
      <img src="imgs/farmer.jpg"/>
     </div>
     <div class="destination" id="droppable" name="2,c">
     </div>
    </td>
    <td id="2d">
     <div class="image">
      <img src="imgs/manager.jpg"/>
     </div>
     <div class="destination" id="droppable" name="2,d">
     </div>
    </td>
   </tr>
   <tr id="3">
    <td id="3a">
     <div class="image">
      <img src="imgs/teacher.jpg"/>
     </div>
     <div class="destination" id="droppable" name="3,a">
     </div>
    </td>
   </tr>
  </table>
  <div id="answers_div">
   <div class="source" id="office worker" name="1,a">
    <div>
     office worker
    </div>
    <img class="sound_button" id="office worker_sound_button" src="../images/sound_button.png"/>
   </div>
   <audio class="source_audio" id="office worker_audio" name="1,a" src="../units/sounds/office worker.mp3">
   </audio>
   <div class="source" id="driver" name="1,b">
    <div>
     driver
    </div>
    <img class="sound_button" id="driver_sound_button" src="../images/sound_button.png"/>
   </div>
   <audio class="source_audio" id="driver_audio" name="1,b" src="../units/sounds/driver.mp3">
   </audio>
   <div class="source" id="cashier" name="1,c">
    <div>
     cashier
    </div>
    <img class="sound_button" id="cashier_sound_button" src="../images/sound_button.png"/>
   </div>
   <audio class="source_audio" id="cashier_audio" name="1,c" src="../units/sounds/cashier.mp3">
   </audio>
   <div class="source" id="factory worker" name="1,d">
    <div>
     factory worker
    </div>
    <img class="sound_button" id="factory worker_sound_button" src="../images/sound_button.png"/>
   </div>
   <audio class="source_audio" id="factory worker_audio" name="1,d" src="../units/sounds/factory worker.mp3">
   </audio>
   <div class="source" id="doctor" name="2,a">
    <div>
     doctor
    </div>
    <img class="sound_button" id="doctor_sound_button" src="../images/sound_button.png"/>
   </div>
   <audio class="source_audio" id="doctor_audio" name="2,a" src="../units/sounds/doctor.mp3">
   </audio>
   <div class="source" id="mechanic" name="2,b">
    <div>
     mechanic
    </div>
    <img class="sound_button" id="mechanic_sound_button" src="../images/sound_button.png"/>
   </div>
   <audio class="source_audio" id="mechanic_audio" name="2,b" src="../units/sounds/mechanic.mp3">
   </audio>
   <div class="source" id="farmer" name="2,c">
    <div>
     farmer
    </div>
    <img class="sound_button" id="farmer_sound_button" src="../images/sound_button.png"/>
   </div>
   <audio class="source_audio" id="farmer_audio" name="2,c" src="../units/sounds/farmer.mp3">
   </audio>
   <div class="source" id="manager" name="2,d">
    <div>
     manager
    </div>
    <img class="sound_button" id="manager_sound_button" src="../images/sound_button.png"/>
   </div>
   <audio class="source_audio" id="manager_audio" name="2,d" src="../units/sounds/manager.mp3">
   </audio>
   <div class="source" id="teacher" name="3,a">
    <div>
     teacher
    </div>
    <img class="sound_button" id="teacher_sound_button" src="../images/sound_button.png"/>
   </div>
   <audio class="source_audio" id="teacher_audio" name="3,a" src="../units/sounds/teacher.mp3">
   </audio>
  </div>
 </body>
</html>